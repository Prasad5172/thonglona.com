"use client";import{useFocusRing as xe}from"@react-aria/focus";import{useHover as ge}from"@react-aria/interactions";import{useVirtualizer as Fe}from"@tanstack/react-virtual";import w,{Fragment as ve,createContext as se,createRef as _e,useCallback as Oe,useContext as de,useMemo as j,useReducer as Ve,useRef as H,useState as De}from"react";import{useActivePress as he}from'../../hooks/use-active-press.js';import{useByComparator as Me}from'../../hooks/use-by-comparator.js';import{useControllable as Le}from'../../hooks/use-controllable.js';import{useDisposables as Ce}from'../../hooks/use-disposables.js';import{useEvent as x}from'../../hooks/use-event.js';import{useId as re}from'../../hooks/use-id.js';import{useIsoMorphicEffect as K}from'../../hooks/use-iso-morphic-effect.js';import{useLatestValue as Be}from'../../hooks/use-latest-value.js';import{useOutsideClick as we}from'../../hooks/use-outside-click.js';import{useOwnerDocument as Ue}from'../../hooks/use-owner.js';import{useResolveButtonType as ke}from'../../hooks/use-resolve-button-type.js';import{useSyncRefs as ae}from'../../hooks/use-sync-refs.js';import{useTrackedPointer as Ne}from'../../hooks/use-tracked-pointer.js';import{useTreeWalker as Ge}from'../../hooks/use-tree-walker.js';import{useWatch as ye}from'../../hooks/use-watch.js';import{useDisabled as He}from'../../internal/disabled.js';import{FloatingProvider as Xe,useFloatingPanel as je,useFloatingReference as Ke}from'../../internal/floating.js';import{FormFields as Je}from'../../internal/form-fields.js';import{useProvidedId as We}from'../../internal/id.js';import{OpenClosedProvider as $e,State as ie,useOpenClosed as ze}from'../../internal/open-closed.js';import{history as Re}from'../../utils/active-element-history.js';import{isDisabledReactIssue7711 as qe}from'../../utils/bugs.js';import{Focus as P,calculateActiveIndex as Ae}from'../../utils/calculate-active-index.js';import{disposables as Se}from'../../utils/disposables.js';import{sortByDomNode as Ye}from'../../utils/focus-management.js';import{match as $}from'../../utils/match.js';import{isMobile as Qe}from'../../utils/platform.js';import{RenderFeatures as Pe,forwardRefWithAs as q,mergeProps as Ee,render as Y}from'../../utils/render.js';import{useDescribedBy as Ze}from'../description/description.js';import{Keys as M}from'../keyboard.js';import{Label as eo,useLabelledBy as be,useLabels as oo}from'../label/label.js';var to=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(to||{}),no=(t=>(t[t.Single=0]="Single",t[t.Multi=1]="Multi",t))(no||{}),ro=(l=>(l[l.Pointer=0]="Pointer",l[l.Focus=1]="Focus",l[l.Other=2]="Other",l))(ro||{}),ao=(a=>(a[a.OpenCombobox=0]="OpenCombobox",a[a.CloseCombobox=1]="CloseCombobox",a[a.GoToOption=2]="GoToOption",a[a.RegisterOption=3]="RegisterOption",a[a.UnregisterOption=4]="UnregisterOption",a[a.SetActivationTrigger=5]="SetActivationTrigger",a[a.UpdateVirtualOptions=6]="UpdateVirtualOptions",a))(ao||{});function ce(e,n=t=>t){let t=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,l=n(e.options.slice()),p=l.length>0&&l[0].dataRef.current.order!==null?l.sort((f,a)=>f.dataRef.current.order-a.dataRef.current.order):Ye(l,f=>f.dataRef.current.domRef.current),b=t?p.indexOf(t):null;return b===-1&&(b=null),{options:p,activeOptionIndex:b}}let io={[1](e){var n;return(n=e.dataRef.current)!=null&&n.disabled||e.comboboxState===1?e:{...e,activeOptionIndex:null,comboboxState:1}},[0](e){var n,t;if((n=e.dataRef.current)!=null&&n.disabled||e.comboboxState===0)return e;if((t=e.dataRef.current)!=null&&t.value){let l=e.dataRef.current.calculateIndex(e.dataRef.current.value);if(l!==-1)return{...e,activeOptionIndex:l,comboboxState:0}}return{...e,comboboxState:0}},[2](e,n){var b,f,a,r,o;if((b=e.dataRef.current)!=null&&b.disabled||(f=e.dataRef.current)!=null&&f.optionsRef.current&&!((a=e.dataRef.current)!=null&&a.optionsPropsRef.current.static)&&e.comboboxState===1)return e;if(e.virtual){let i=n.focus===P.Specific?n.idx:Ae(n,{resolveItems:()=>e.virtual.options,resolveActiveIndex:()=>{var v,T;return(T=(v=e.activeOptionIndex)!=null?v:e.virtual.options.findIndex(d=>!e.virtual.disabled(d)))!=null?T:null},resolveDisabled:e.virtual.disabled,resolveId(){throw new Error("Function not implemented.")}}),A=(r=n.trigger)!=null?r:2;return e.activeOptionIndex===i&&e.activationTrigger===A?e:{...e,activeOptionIndex:i,activationTrigger:A}}let t=ce(e);if(t.activeOptionIndex===null){let i=t.options.findIndex(A=>!A.dataRef.current.disabled);i!==-1&&(t.activeOptionIndex=i)}let l=n.focus===P.Specific?n.idx:Ae(n,{resolveItems:()=>t.options,resolveActiveIndex:()=>t.activeOptionIndex,resolveId:i=>i.id,resolveDisabled:i=>i.dataRef.current.disabled}),p=(o=n.trigger)!=null?o:2;return e.activeOptionIndex===l&&e.activationTrigger===p?e:{...e,...t,activeOptionIndex:l,activationTrigger:p}},[3]:(e,n)=>{var b,f,a;if((b=e.dataRef.current)!=null&&b.virtual)return{...e,options:[...e.options,n.payload]};let t=n.payload,l=ce(e,r=>(r.push(t),r));e.activeOptionIndex===null&&(f=e.dataRef.current)!=null&&f.isSelected(n.payload.dataRef.current.value)&&(l.activeOptionIndex=l.options.indexOf(t));let p={...e,...l,activationTrigger:2};return(a=e.dataRef.current)!=null&&a.__demoMode&&e.dataRef.current.value===void 0&&(p.activeOptionIndex=0),p},[4]:(e,n)=>{var l;if((l=e.dataRef.current)!=null&&l.virtual)return{...e,options:e.options.filter(p=>p.id!==n.id)};let t=ce(e,p=>{let b=p.findIndex(f=>f.id===n.id);return b!==-1&&p.splice(b,1),p});return{...e,...t,activationTrigger:2}},[5]:(e,n)=>e.activationTrigger===n.trigger?e:{...e,activationTrigger:n.trigger},[6]:(e,n)=>{var l;if(((l=e.virtual)==null?void 0:l.options)===n.options)return e;let t=e.activeOptionIndex;if(e.activeOptionIndex!==null){let p=n.options.indexOf(e.virtual.options[e.activeOptionIndex]);p!==-1?t=p:t=null}return{...e,activeOptionIndex:t,virtual:Object.assign({},e.virtual,{options:n.options})}}},fe=se(null);fe.displayName="ComboboxActionsContext";function le(e){let n=de(fe);if(n===null){let t=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,le),t}return n}let Ie=se(null);function lo(e){var a;let n=z("VirtualProvider"),[t,l]=j(()=>{let r=n.optionsRef.current;if(!r)return[0,0];let o=window.getComputedStyle(r);return[parseFloat(o.paddingBlockStart||o.paddingTop),parseFloat(o.paddingBlockEnd||o.paddingBottom)]},[n.optionsRef.current]),p=Fe({scrollPaddingStart:t,scrollPaddingEnd:l,count:n.virtual.options.length,estimateSize(){return 40},getScrollElement(){var r;return(r=n.optionsRef.current)!=null?r:null},overscan:12}),[b,f]=De(0);return K(()=>{f(r=>r+1)},[(a=n.virtual)==null?void 0:a.options]),w.createElement(Ie.Provider,{value:p},w.createElement("div",{style:{position:"relative",width:"100%",height:`${p.getTotalSize()}px`},ref:r=>{if(r){if(typeof process!="undefined"&&process.env.JEST_WORKER_ID!==void 0||n.activationTrigger===0)return;n.activeOptionIndex!==null&&n.virtual.options.length>n.activeOptionIndex&&p.scrollToIndex(n.activeOptionIndex)}}},p.getVirtualItems().map(r=>{var o;return w.createElement(ve,{key:r.key},w.cloneElement((o=e.children)==null?void 0:o.call(e,{option:n.virtual.options[r.index],open:n.comboboxState===0}),{key:`${b}-${r.key}`,"data-index":r.index,"aria-setsize":n.virtual.options.length,"aria-posinset":r.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${r.start}px)`,overflowAnchor:"none"}}))})))}let me=se(null);me.displayName="ComboboxDataContext";function z(e){let n=de(me);if(n===null){let t=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,z),t}return n}function uo(e,n){return $(n.type,io,e,n)}let po=ve;function so(e,n){var O,h;let t=He(),{value:l,defaultValue:p,onChange:b,form:f,name:a,by:r,disabled:o=t||!1,__demoMode:i=!1,nullable:A=!1,multiple:v=!1,immediate:T=!1,virtual:d=null,...L}=e,[y=v?[]:void 0,m]=Le(l,b,p),[F,_]=Ve(uo,{dataRef:_e(),comboboxState:i?0:1,options:[],virtual:d?{options:d.options,disabled:(O=d.disabled)!=null?O:()=>!1}:null,activeOptionIndex:null,activationTrigger:2}),V=H(!1),k=H({static:!1,hold:!1}),N=H(null),S=H(null),E=H(null),G=Me(r),X=x(c=>d?r===null?d.options.indexOf(c):d.options.findIndex(g=>G(g,c)):F.options.findIndex(g=>G(g.dataRef.current.value,c))),R=Oe(c=>$(s.mode,{[1]:()=>y.some(g=>G(g,c)),[0]:()=>G(y,c)}),[y]),C=x(c=>F.activeOptionIndex===X(c)),s=j(()=>({...F,immediate:T,optionsPropsRef:k,inputRef:N,buttonRef:S,optionsRef:E,value:y,defaultValue:p,disabled:o,mode:v?1:0,virtual:F.virtual,get activeOptionIndex(){if(V.current&&F.activeOptionIndex===null&&(d?d.options.length>0:F.options.length>0)){if(d){let g=d.options.findIndex(U=>{var ne,Te;return!((Te=(ne=d==null?void 0:d.disabled)==null?void 0:ne.call(d,U))!=null&&Te)});if(g!==-1)return g}let c=F.options.findIndex(g=>!g.dataRef.current.disabled);if(c!==-1)return c}return F.activeOptionIndex},calculateIndex:X,compare:G,isSelected:R,isActive:C,nullable:A,__demoMode:i}),[y,p,o,v,A,i,F,d]);K(()=>{d&&_({type:6,options:d.options})},[d,d==null?void 0:d.options]),K(()=>{F.dataRef.current=s},[s]),we([s.buttonRef,s.inputRef,s.optionsRef],()=>W.closeCombobox(),s.comboboxState===0);let ue=j(()=>{var c,g,U;return{open:s.comboboxState===0,disabled:o,activeIndex:s.activeOptionIndex,activeOption:s.activeOptionIndex===null?null:s.virtual?s.virtual.options[(c=s.activeOptionIndex)!=null?c:0]:(U=(g=s.options[s.activeOptionIndex])==null?void 0:g.dataRef.current.value)!=null?U:null,value:y}},[s,o,y]),pe=x(()=>{if(s.activeOptionIndex!==null){if(s.virtual)J(s.virtual.options[s.activeOptionIndex]);else{let{dataRef:c}=s.options[s.activeOptionIndex];J(c.current.value)}W.goToOption(P.Specific,s.activeOptionIndex)}}),Q=x(()=>{_({type:0}),V.current=!0}),Z=x(()=>{_({type:1}),V.current=!1}),ee=x((c,g,U)=>(V.current=!1,c===P.Specific?_({type:2,focus:P.Specific,idx:g,trigger:U}):_({type:2,focus:c,trigger:U}))),oe=x((c,g)=>(_({type:3,payload:{id:c,dataRef:g}}),()=>{s.isActive(g.current.value)&&(V.current=!0),_({type:4,id:c})})),J=x(c=>$(s.mode,{[0](){return m==null?void 0:m(c)},[1](){let g=s.value.slice(),U=g.findIndex(ne=>G(ne,c));return U===-1?g.push(c):g.splice(U,1),m==null?void 0:m(g)}})),te=x(c=>{_({type:5,trigger:c})}),W=j(()=>({onChange:J,registerOption:oe,goToOption:ee,closeCombobox:Z,openCombobox:Q,setActivationTrigger:te,selectActiveOption:pe}),[]),[u,D]=oo(),I=n===null?{}:{ref:n},B=Oe(()=>m==null?void 0:m(p),[m]);return w.createElement(D,{value:u,props:{htmlFor:(h=s.inputRef.current)==null?void 0:h.id},slot:{open:s.comboboxState===0,disabled:o}},w.createElement(Xe,null,w.createElement(fe.Provider,{value:W},w.createElement(me.Provider,{value:s},w.createElement($e,{value:$(s.comboboxState,{[0]:ie.Open,[1]:ie.Closed})},a!=null&&w.createElement(Je,{data:y!=null?{[a]:y}:{},form:f,onReset:B}),Y({ourProps:I,theirProps:L,slot:ue,defaultTag:po,name:"Combobox"}))))))}let bo="input";function co(e,n){var Q,Z,ee,oe,J,te,W;let t=re(),l=We(),{id:p=l||`headlessui-combobox-input-${t}`,onChange:b,displayValue:f,type:a="text",...r}=e,o=z("Combobox.Input"),i=le("Combobox.Input"),A=ae(o.inputRef,n,Ke()),v=Ue(o.inputRef),T=H(!1),d=Ce(),L=x(()=>{i.onChange(null),o.optionsRef.current&&(o.optionsRef.current.scrollTop=0),i.goToOption(P.Nothing)}),y=function(){var u;return typeof f=="function"&&o.value!==void 0?(u=f(o.value))!=null?u:"":typeof o.value=="string"?o.value:""}();ye(([u,D],[I,B])=>{if(T.current)return;let O=o.inputRef.current;O&&((B===0&&D===1||u!==I)&&(O.value=u),requestAnimationFrame(()=>{if(T.current||!O||(v==null?void 0:v.activeElement)!==O)return;let{selectionStart:h,selectionEnd:c}=O;Math.abs((c!=null?c:0)-(h!=null?h:0))===0&&h===0&&O.setSelectionRange(O.value.length,O.value.length)}))},[y,o.comboboxState,v]),ye(([u],[D])=>{if(u===0&&D===1){if(T.current)return;let I=o.inputRef.current;if(!I)return;let B=I.value,{selectionStart:O,selectionEnd:h,selectionDirection:c}=I;I.value="",I.value=B,c!==null?I.setSelectionRange(O,h,c):I.setSelectionRange(O,h)}},[o.comboboxState]);let m=H(!1),F=x(()=>{m.current=!0}),_=x(()=>{d.nextFrame(()=>{m.current=!1})}),V=x(u=>{switch(T.current=!0,u.key){case M.Enter:if(T.current=!1,o.comboboxState!==0||m.current)return;if(u.preventDefault(),u.stopPropagation(),o.activeOptionIndex===null){i.closeCombobox();return}i.selectActiveOption(),o.mode===0&&i.closeCombobox();break;case M.ArrowDown:return T.current=!1,u.preventDefault(),u.stopPropagation(),$(o.comboboxState,{[0]:()=>i.goToOption(P.Next),[1]:()=>i.openCombobox()});case M.ArrowUp:return T.current=!1,u.preventDefault(),u.stopPropagation(),$(o.comboboxState,{[0]:()=>i.goToOption(P.Previous),[1]:()=>{i.openCombobox(),d.nextFrame(()=>{o.value||i.goToOption(P.Last)})}});case M.Home:if(u.shiftKey)break;return T.current=!1,u.preventDefault(),u.stopPropagation(),i.goToOption(P.First);case M.PageUp:return T.current=!1,u.preventDefault(),u.stopPropagation(),i.goToOption(P.First);case M.End:if(u.shiftKey)break;return T.current=!1,u.preventDefault(),u.stopPropagation(),i.goToOption(P.Last);case M.PageDown:return T.current=!1,u.preventDefault(),u.stopPropagation(),i.goToOption(P.Last);case M.Escape:return T.current=!1,o.comboboxState!==0?void 0:(u.preventDefault(),o.optionsRef.current&&!o.optionsPropsRef.current.static&&u.stopPropagation(),o.nullable&&o.mode===0&&o.value===null&&L(),i.closeCombobox());case M.Tab:if(T.current=!1,o.comboboxState!==0)return;o.mode===0&&o.activationTrigger!==1&&i.selectActiveOption(),i.closeCombobox();break}}),k=x(u=>{b==null||b(u),o.nullable&&o.mode===0&&u.target.value===""&&L(),i.openCombobox()}),N=x(u=>{var I,B,O;let D=(I=u.relatedTarget)!=null?I:Re.find(h=>h!==u.currentTarget);if(T.current=!1,!((B=o.optionsRef.current)!=null&&B.contains(D))&&!((O=o.buttonRef.current)!=null&&O.contains(D))&&o.comboboxState===0)return u.preventDefault(),o.mode===0&&(o.nullable&&o.value===null?L():o.activationTrigger!==1&&i.selectActiveOption()),i.closeCombobox()}),S=x(u=>{var I,B,O;let D=(I=u.relatedTarget)!=null?I:Re.find(h=>h!==u.currentTarget);(B=o.buttonRef.current)!=null&&B.contains(D)||(O=o.optionsRef.current)!=null&&O.contains(D)||o.disabled||o.immediate&&o.comboboxState!==0&&(i.openCombobox(),d.nextFrame(()=>{i.setActivationTrigger(1)}))}),E=be(),G=Ze(),{isFocusVisible:X,focusProps:R}=xe({isTextInput:!0,autoFocus:(Q=e.autoFocus)!=null?Q:!1}),{isHovered:C,hoverProps:s}=ge({isDisabled:(Z=o.disabled)!=null?Z:!1}),ue=j(()=>{var u;return{open:o.comboboxState===0,disabled:o.disabled,hover:C,focus:X,autofocus:(u=e.autoFocus)!=null?u:!1}},[o,C,X,e.autoFocus]),pe=Ee({ref:A,id:p,role:"combobox",type:a,"aria-controls":(ee=o.optionsRef.current)==null?void 0:ee.id,"aria-expanded":o.comboboxState===0,"aria-activedescendant":o.activeOptionIndex===null?void 0:o.virtual?(oe=o.options.find(u=>{var D;return!((D=o.virtual)!=null&&D.disabled(u.dataRef.current.value))&&o.compare(u.dataRef.current.value,o.virtual.options[o.activeOptionIndex])}))==null?void 0:oe.id:(J=o.options[o.activeOptionIndex])==null?void 0:J.id,"aria-labelledby":E,"aria-describedby":G,"aria-autocomplete":"list",defaultValue:(W=(te=e.defaultValue)!=null?te:o.defaultValue!==void 0?f==null?void 0:f(o.defaultValue):null)!=null?W:o.defaultValue,disabled:o.disabled,onCompositionStart:F,onCompositionEnd:_,onKeyDown:V,onChange:k,onFocus:S,onBlur:N},R,s);return Y({ourProps:pe,theirProps:r,slot:ue,defaultTag:bo,name:"Combobox.Input"})}let fo="button";function mo(e,n){var V,k,N;let t=z("Combobox.Button"),l=le("Combobox.Button"),p=ae(t.buttonRef,n),b=re(),{id:f=`headlessui-combobox-button-${b}`,...a}=e,r=Ce(),o=x(S=>{switch(S.key){case M.ArrowDown:return S.preventDefault(),S.stopPropagation(),t.comboboxState===1&&l.openCombobox(),r.nextFrame(()=>{var E;return(E=t.inputRef.current)==null?void 0:E.focus({preventScroll:!0})});case M.ArrowUp:return S.preventDefault(),S.stopPropagation(),t.comboboxState===1&&(l.openCombobox(),r.nextFrame(()=>{t.value||l.goToOption(P.Last)})),r.nextFrame(()=>{var E;return(E=t.inputRef.current)==null?void 0:E.focus({preventScroll:!0})});case M.Escape:return t.comboboxState!==0?void 0:(S.preventDefault(),t.optionsRef.current&&!t.optionsPropsRef.current.static&&S.stopPropagation(),l.closeCombobox(),r.nextFrame(()=>{var E;return(E=t.inputRef.current)==null?void 0:E.focus({preventScroll:!0})}));default:return}}),i=x(S=>{if(qe(S.currentTarget))return S.preventDefault();t.comboboxState===0?l.closeCombobox():(S.preventDefault(),l.openCombobox()),r.nextFrame(()=>{var E;return(E=t.inputRef.current)==null?void 0:E.focus({preventScroll:!0})})}),A=be([f]),{isFocusVisible:v,focusProps:T}=xe({isTextInput:!0,autoFocus:(V=e.autoFocus)!=null?V:!1}),{isHovered:d,hoverProps:L}=ge({isDisabled:(k=t.disabled)!=null?k:!1}),{pressed:y,pressProps:m}=he(),F=j(()=>({open:t.comboboxState===0,active:y||t.comboboxState===0,disabled:t.disabled,value:t.value,hover:d,focus:v}),[t,d,v,y]),_=Ee({ref:p,id:f,type:ke(e,t.buttonRef),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":(N=t.optionsRef.current)==null?void 0:N.id,"aria-expanded":t.comboboxState===0,"aria-labelledby":A,disabled:t.disabled,onClick:i,onKeyDown:o},T,L,m);return Y({ourProps:_,theirProps:a,slot:F,defaultTag:fo,name:"Combobox.Button"})}let To="ul",xo=Pe.RenderStrategy|Pe.Static;function go(e,n){var y;let t=re(),{id:l=`headlessui-combobox-options-${t}`,hold:p=!1,anchor:b,...f}=e,a=z("Combobox.Options"),[r,o]=je(b),i=ae(a.optionsRef,n,r),A=ze(),v=(()=>A!==null?(A&ie.Open)===ie.Open:a.comboboxState===0)();K(()=>{var m;a.optionsPropsRef.current.static=(m=e.static)!=null?m:!1},[a.optionsPropsRef,e.static]),K(()=>{a.optionsPropsRef.current.hold=p},[a.optionsPropsRef,p]),Ge({container:a.optionsRef.current,enabled:a.comboboxState===0,accept(m){return m.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:m.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(m){m.setAttribute("role","none")}});let T=be([(y=a.buttonRef.current)==null?void 0:y.id]),d=j(()=>({open:a.comboboxState===0,option:void 0}),[a]),L={"aria-labelledby":T,role:"listbox","aria-multiselectable":a.mode===1?!0:void 0,id:l,ref:i,...o?{style:o}:{}};return a.virtual&&a.comboboxState===0&&Object.assign(f,{children:w.createElement(lo,null,f.children)}),Y({ourProps:L,theirProps:f,slot:d,defaultTag:To,features:xo,visible:v,name:"Combobox.Options"})}let vo="li";function Oo(e,n){var X;let t=re(),{id:l=`headlessui-combobox-option-${t}`,disabled:p=!1,value:b,order:f=null,...a}=e,r=z("Combobox.Option"),o=le("Combobox.Option"),i=r.virtual?r.activeOptionIndex===r.calculateIndex(b):r.activeOptionIndex===null?!1:((X=r.options[r.activeOptionIndex])==null?void 0:X.id)===l,A=r.isSelected(b),v=H(null),T=Be({disabled:p,value:b,domRef:v,order:f}),d=de(Ie),L=ae(n,v,d?d.measureElement:null),y=x(()=>o.onChange(b));K(()=>o.registerOption(l,T),[T,l]);let m=H(!(r.virtual||r.__demoMode));K(()=>{if(!r.virtual||!r.__demoMode)return;let R=Se();return R.requestAnimationFrame(()=>{m.current=!0}),R.dispose},[r.virtual,r.__demoMode]),K(()=>{if(!m.current||r.comboboxState!==0||!i||r.activationTrigger===0)return;let R=Se();return R.requestAnimationFrame(()=>{var C,s;(s=(C=v.current)==null?void 0:C.scrollIntoView)==null||s.call(C,{block:"nearest"})}),R.dispose},[v,i,r.comboboxState,r.activationTrigger,r.activeOptionIndex]);let F=x(R=>{var C;if(p||(C=r.virtual)!=null&&C.disabled(b))return R.preventDefault();y(),Qe()||requestAnimationFrame(()=>{var s;return(s=r.inputRef.current)==null?void 0:s.focus({preventScroll:!0})}),r.mode===0&&requestAnimationFrame(()=>o.closeCombobox())}),_=x(()=>{var C;if(p||(C=r.virtual)!=null&&C.disabled(b))return o.goToOption(P.Nothing);let R=r.calculateIndex(b);o.goToOption(P.Specific,R)}),V=Ne(),k=x(R=>V.update(R)),N=x(R=>{var s;if(!V.wasMoved(R)||p||(s=r.virtual)!=null&&s.disabled(b)||i)return;let C=r.calculateIndex(b);o.goToOption(P.Specific,C,0)}),S=x(R=>{var C;V.wasMoved(R)&&(p||(C=r.virtual)!=null&&C.disabled(b)||i&&(r.optionsPropsRef.current.hold||o.goToOption(P.Nothing)))}),E=j(()=>({active:i,focus:i,selected:A,disabled:p}),[i,A,p]);return Y({ourProps:{id:l,ref:L,role:"option",tabIndex:p===!0?void 0:-1,"aria-disabled":p===!0?!0:void 0,"aria-selected":A,disabled:void 0,onClick:F,onFocus:_,onPointerEnter:k,onMouseEnter:k,onPointerMove:N,onMouseMove:N,onPointerLeave:S,onMouseLeave:S},theirProps:a,slot:E,defaultTag:vo,name:"Combobox.Option"})}let Co=q(so),yo=q(mo),Ro=q(co),Ao=eo,So=q(go),Po=q(Oo),pt=Object.assign(Co,{Input:Ro,Button:yo,Label:Ao,Options:So,Option:Po});export{pt as Combobox,yo as ComboboxButton,Ro as ComboboxInput,Ao as ComboboxLabel,Po as ComboboxOption,So as ComboboxOptions};
