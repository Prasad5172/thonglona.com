import{disposables as m}from'../../utils/disposables.js';import{isIOS as f}from'../../utils/platform.js';function d(){if(!f())return{};let l;return{before(){var t;l=(t=window.scrollY)!=null?t:window.pageYOffset},after({doc:t,d:n,meta:s}){function i(o){return s.containers.flatMap(e=>e()).some(e=>e.contains(o))}n.microTask(()=>{if(window.getComputedStyle(t.documentElement).scrollBehavior!=="auto"){let e=m();e.style(t.documentElement,"scroll-behavior","auto"),n.add(()=>n.microTask(()=>e.dispose()))}n.style(t.body,"marginTop",`-${l}px`),window.scrollTo(0,0);let o=null;n.addEventListener(t,"click",e=>{if(e.target instanceof HTMLElement)try{let r=e.target.closest("a");if(!r)return;let{hash:c}=new URL(r.href),a=t.querySelector(c);a&&!i(a)&&(o=a)}catch{}},!0),n.addEventListener(t,"touchmove",e=>{e.target instanceof HTMLElement&&!i(e.target)&&e.preventDefault()},{passive:!1}),n.add(()=>{var e;window.scrollTo(0,((e=window.scrollY)!=null?e:window.pageYOffset)+l),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}}export{d as handleIOSLocking};
